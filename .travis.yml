language: csharp
dotnet: 2.2.301
install:
  - make install-deps
stages:
  - test
  - name: deploy
    if: tag IS present
jobs:
  include:
    - stage: test
      name: 'All Tests'
      script:
        - dotnet restore
        - make release-distro
        # - make test
    - stage: deploy
      name: 'Deploy to Github'
      script: skip
      before_deploy:
        - make release-distro
      deploy:
        provider: releases
        on:
          tags: true
          repo: disunity-hq/disunity
        draft: true
        skip_cleanup: true
        name: $TRAVIS_TAG
        file_glob: true
        files:
          -
cache:
  directories:
    - $HOME/.paket
notifications:
  email: false
